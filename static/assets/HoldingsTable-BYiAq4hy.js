import{c as T,r as N,j as e,S as B,W as D,I as M,B as A,T as $,a as m,b as x,d as O,e as l,f as c,g as U,h as X,i as Q,k}from"./index-Drlt8vmO.js";const W=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],z=T("download",W);const G=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],P=T("search",G),K=N.memo(function({holdings:p,totalMarketValue:C}){const[y,I]=N.useState(""),u=C||1,S=N.useMemo(()=>{if(!y.trim())return p;const s=y.toLowerCase().trim();return p.filter(a=>a.scheme_name.toLowerCase().includes(s)||a.sub_category.toLowerCase().includes(s)||a.category.toLowerCase().includes(s)||a.style_category&&a.style_category.toLowerCase().includes(s))},[p,y]),{equityHoldings:f,debtHoldings:g,otherHoldings:b,equityTotal:F,debtTotal:R,otherTotal:L,equityInvestedTotal:q,debtInvestedTotal:E,otherInvestedTotal:H}=N.useMemo(()=>{const s=[],a=[],r=[];let n=0,d=0,j=0,t=0,i=0,w=0;return p.forEach(o=>{o.category==="Equity"?(s.push(o),n+=o.market_value,t+=o.cost_value||0):o.category==="Fixed Income"?(a.push(o),d+=o.market_value,i+=o.cost_value||0):(r.push(o),j+=o.market_value,w+=o.cost_value||0)}),{equityHoldings:s,debtHoldings:a,otherHoldings:r,equityTotal:n,debtTotal:d,otherTotal:j,equityInvestedTotal:t,debtInvestedTotal:i,otherInvestedTotal:w}},[S]),h=s=>{const a=s.category.toLowerCase(),r=s.sub_category.toLowerCase(),n=s.scheme_name.toLowerCase();return n.includes("nifty 50")||n.includes("nifty50")?"Nifty 50":n.includes("nifty midcap")||n.includes("niftymidcap")?"Nifty Midcap 150":n.includes("nifty smallcap")||n.includes("niftysmallcap")?"Nifty Smallcap 250":n.includes("nifty 500")||n.includes("nifty500")?"Nifty 500":n.includes("sensex")?"Sensex":a==="equity"?r.includes("large cap")||r.includes("large-cap")?"Nifty 50":r.includes("mid cap")||r.includes("mid-cap")?"Nifty Midcap 150":r.includes("small cap")||r.includes("small-cap")?"Nifty Smallcap 250":r.includes("flexi cap")||r.includes("flexi-cap")||r.includes("multi cap")||r.includes("multi-cap")||r.includes("elss")?"Nifty 500":(r.includes("sectoral")||r.includes("thematic"),"Nifty 50"):a==="fixed income"?r.includes("liquid")||r.includes("money market")?"CRISIL Liquid":r.includes("ultra short term")||r.includes("ultra-short")?"CRISIL Ultra Short Term":r.includes("short term")||r.includes("short-term")?"CRISIL Short Term":r.includes("medium term")||r.includes("medium-term")?"CRISIL Medium Term":r.includes("long term")||r.includes("long-term")?"CRISIL Long Term":"CRISIL Composite":null},V=()=>{const s=["Fund Name","Category","Sub Category","Style","Entry Date","Invested Value (₹)","Market Value (₹)","Allocation (%)","Absolute Returns (%)","XIRR (%)","Benchmark XIRR (%)","Benchmark Name"],a=[];f.length>0&&(a.push(["EQUITY"]),f.forEach(t=>{const i=h(t)||"";a.push([t.scheme_name,t.category,t.sub_category,t.style_category||"",t.date_of_entry||"",c(t.cost_value||0),c(t.market_value||0),((t.market_value||0)/u*100).toFixed(2),(t.return_pct??0).toFixed(2),(t.xirr??0).toFixed(2),(t.benchmark_xirr??0).toFixed(2),i])}),a.push([])),g.length>0&&(a.push(["FIXED INCOME / DEBT"]),g.forEach(t=>{const i=h(t)||"";a.push([t.scheme_name,t.category,t.sub_category,t.style_category||"",t.date_of_entry||"",c(t.cost_value||0),c(t.market_value||0),((t.market_value||0)/u*100).toFixed(2),(t.return_pct??0).toFixed(2),(t.xirr??0).toFixed(2),(t.benchmark_xirr??0).toFixed(2),i])}),a.push([])),b.length>0&&(a.push(["OTHERS"]),b.forEach(t=>{const i=h(t)||"";a.push([t.scheme_name,t.category,t.sub_category,t.style_category||"",t.date_of_entry||"",c(t.cost_value||0),c(t.market_value||0),((t.market_value||0)/u*100).toFixed(2),(t.return_pct??0).toFixed(2),(t.xirr??0).toFixed(2),(t.benchmark_xirr??0).toFixed(2),i])}));const r=[s.join(","),...a.map(t=>t.map(i=>`"${i.replace(/"/g,'""')}"`).join(","))].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),j=URL.createObjectURL(n);d.setAttribute("href",j),d.setAttribute("download",`holdings_export_${new Date().toISOString().split("T")[0]}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)},v=(s,a,r)=>e.jsxs(m,{className:"bg-muted/30 border-t-2 border-border",children:[e.jsxs(l,{colSpan:2,className:"px-4 py-3 sm:px-8 sm:py-5 font-bold text-foreground",children:[s," Total"]}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:e.jsxs("div",{className:"font-bold text-foreground font-mono text-base",children:["₹",c(r)]})}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsxs("div",{className:"font-bold text-foreground font-mono text-base",children:["₹",c(a)]}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:[(a/u*100).toFixed(1),"%"]})]}),e.jsx(l,{colSpan:2})]}),_=(s,a)=>{const r=h(s);return e.jsxs(m,{className:"hover:bg-muted/50",children:[e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 whitespace-normal max-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs(U,{children:[e.jsx(X,{asChild:!0,children:e.jsx("div",{className:"font-bold text-foreground text-sm truncate flex-1 min-w-0 cursor-help",children:s.scheme_name})}),e.jsx(Q,{children:e.jsx("p",{className:"max-w-xs break-words",children:s.scheme_name})})]}),s.style_category&&e.jsx(k,{variant:"secondary",className:"text-[10px] uppercase flex-shrink-0",children:s.style_category})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsx("div",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-wider truncate",title:s.sub_category,children:s.sub_category}),r&&e.jsx(k,{variant:"outline",className:"text-[10px] uppercase flex-shrink-0",children:r})]})]}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5",children:e.jsx("div",{className:"text-xs font-mono text-muted-foreground",children:s.date_of_entry||"-"})}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:e.jsxs("div",{className:"font-bold text-foreground font-mono",children:["₹",c(s.cost_value||0)]})}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsxs("div",{className:"font-bold text-foreground font-mono",children:["₹",c(s.market_value||0)]}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:[((s.market_value||0)/u*100).toFixed(1),"%"]})]}),e.jsxs(l,{className:`px-4 py-3 sm:px-8 sm:py-5 text-right font-bold font-mono ${(s.gain_loss??0)>=0?"text-primary":"text-destructive"}`,children:[s.return_pct??0,"%"]}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsx("div",{className:`font-bold font-mono text-sm ${(s.xirr??0)>=0?"text-green-500":"text-red-500"}`,children:s.xirr?s.xirr.toFixed(1)+"%":"-"}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:["BM: ",s.benchmark_xirr?s.benchmark_xirr.toFixed(1)+"%":"-"]})]})]},a)};return e.jsxs("div",{className:"mt-12 pt-12 border-t border-border",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-6",children:[e.jsx("h3",{className:"font-bold text-xl text-foreground",children:"Full Holding List"}),e.jsx(B,{title:"Full Holding List",formula:e.jsxs(e.Fragment,{children:["Value = Units × NAV",e.jsx("br",{}),"Allocation % = (Holding Value ÷ Total Portfolio Value) × 100",e.jsx("br",{}),"Return % = ((Current Value − Cost Value) ÷ Cost Value) × 100"]}),content:e.jsx(e.Fragment,{children:"All holdings from your statement: scheme name, category, market value (in ₹), allocation % of portfolio, return %, and style (e.g. Growth). Holdings are grouped by Equity and Debt with subtotals."})})]}),e.jsxs(D,{className:"overflow-hidden",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(M,{type:"text",placeholder:"Search by fund name, category, or style...",value:y,onChange:s=>I(s.target.value),className:"pl-9 w-full max-w-md"})]}),e.jsxs(A,{onClick:V,variant:"outline",size:"default",className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Download CSV"]})]}),e.jsx("div",{className:"w-full overflow-hidden",children:e.jsx("div",{className:"relative w-full overflow-hidden",children:e.jsxs("table",{className:"w-full caption-bottom text-sm table-fixed",children:[e.jsx($,{children:e.jsxs(m,{className:"bg-muted border-b border-border",children:[e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 w-[25%]",children:"Fund Name / Category"}),e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 w-[12%]",children:"Entry Date"}),e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[15%]",children:"Invested Value"}),e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[15%]",children:"Current Value"}),e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[12%]",children:"Abs Returns"}),e.jsx(x,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[21%]",children:"XIRR / BM"})]})}),e.jsxs(O,{children:[f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Equity"})}),f.map((s,a)=>_(s,`eq-${a}`)),v("Equity",F,q)]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Fixed Income / Debt"})}),g.map((s,a)=>_(s,`debt-${a}`)),v("Debt",R,E)]}),b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Others"})}),b.map((s,a)=>_(s,`other-${a}`)),v("Others",L,H)]})]})]})})})]})]})});export{K as HoldingsTable};
