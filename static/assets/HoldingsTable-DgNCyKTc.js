import{c as I,r as N,j as e,S as D,W as M,I as $,B as A,T as O,a as x,b as u,d as X,e as l,f as d,g as U,h as Q,i as P,k as C}from"./index-DYgTdDiw.js";const W=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],z=I("download",W);const G=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Y=I("search",G),Z=N.memo(function({holdings:v,totalMarketValue:S}){const[y,F]=N.useState(""),p=S||1,k=N.useMemo(()=>{if(!y.trim())return v;const t=y.toLowerCase().trim();return v.filter(a=>a.scheme_name.toLowerCase().includes(t)||a.sub_category.toLowerCase().includes(t)||a.category.toLowerCase().includes(t)||a.style_category&&a.style_category.toLowerCase().includes(t))},[v,y]),{equityHoldings:f,debtHoldings:g,otherHoldings:b,equityTotal:R,debtTotal:L,otherTotal:q,equityInvestedTotal:E,debtInvestedTotal:H,otherInvestedTotal:V}=N.useMemo(()=>{const t=[],a=[],r=[];let n=0,o=0,j=0,s=0,c=0,T=0;return k.forEach(i=>{i.category==="Equity"?(t.push(i),n+=i.market_value,s+=i.cost_value||0):i.category==="Fixed Income"?(a.push(i),o+=i.market_value,c+=i.cost_value||0):(r.push(i),j+=i.market_value,T+=i.cost_value||0)}),{equityHoldings:t,debtHoldings:a,otherHoldings:r,equityTotal:n,debtTotal:o,otherTotal:j,equityInvestedTotal:s,debtInvestedTotal:c,otherInvestedTotal:T}},[k]),h=t=>{const a=t.category.toLowerCase(),r=t.sub_category.toLowerCase(),n=t.scheme_name.toLowerCase();return n.includes("nifty 50")||n.includes("nifty50")?"Nifty 50":n.includes("nifty midcap")||n.includes("niftymidcap")?"Nifty Midcap 150":n.includes("nifty smallcap")||n.includes("niftysmallcap")?"Nifty Smallcap 250":n.includes("nifty 500")||n.includes("nifty500")?"Nifty 500":n.includes("sensex")?"Sensex":a==="equity"?r.includes("large cap")||r.includes("large-cap")?"Nifty 50":r.includes("mid cap")||r.includes("mid-cap")?"Nifty Midcap 150":r.includes("small cap")||r.includes("small-cap")?"Nifty Smallcap 250":r.includes("flexi cap")||r.includes("flexi-cap")||r.includes("multi cap")||r.includes("multi-cap")||r.includes("elss")?"Nifty 500":(r.includes("sectoral")||r.includes("thematic"),"Nifty 50"):a==="fixed income"?r.includes("liquid")||r.includes("money market")?"CRISIL Liquid":r.includes("ultra short term")||r.includes("ultra-short")?"CRISIL Ultra Short Term":r.includes("short term")||r.includes("short-term")?"CRISIL Short Term":r.includes("medium term")||r.includes("medium-term")?"CRISIL Medium Term":r.includes("long term")||r.includes("long-term")?"CRISIL Long Term":"CRISIL Composite":null},m=t=>t!=null?t.toFixed(2):"",B=()=>{const t=["Fund Name","Category","Sub Category","Style","Entry Date","Invested Value (₹)","Market Value (₹)","Allocation (%)","Absolute Returns (%)","XIRR (%)","Benchmark XIRR (%)","Benchmark Name"],a=[];f.length>0&&(a.push(["EQUITY"]),f.forEach(s=>{const c=h(s)||"";a.push([s.scheme_name,s.category,s.sub_category,s.style_category||"",s.date_of_entry||"",d(s.cost_value||0),d(s.market_value||0),((s.market_value||0)/p*100).toFixed(2),(s.return_pct??0).toFixed(2),m(s.xirr),m(s.benchmark_xirr),c])}),a.push([])),g.length>0&&(a.push(["FIXED INCOME / DEBT"]),g.forEach(s=>{const c=h(s)||"";a.push([s.scheme_name,s.category,s.sub_category,s.style_category||"",s.date_of_entry||"",d(s.cost_value||0),d(s.market_value||0),((s.market_value||0)/p*100).toFixed(2),(s.return_pct??0).toFixed(2),m(s.xirr),m(s.benchmark_xirr),c])}),a.push([])),b.length>0&&(a.push(["OTHERS"]),b.forEach(s=>{const c=h(s)||"";a.push([s.scheme_name,s.category,s.sub_category,s.style_category||"",s.date_of_entry||"",d(s.cost_value||0),d(s.market_value||0),((s.market_value||0)/p*100).toFixed(2),(s.return_pct??0).toFixed(2),m(s.xirr),m(s.benchmark_xirr),c])}));const r=[t.join(","),...a.map(s=>s.map(c=>`"${c.replace(/"/g,'""')}"`).join(","))].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),j=URL.createObjectURL(n);o.setAttribute("href",j),o.setAttribute("download",`holdings_export_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},_=(t,a,r)=>e.jsxs(x,{className:"bg-muted/30 border-t-2 border-border",children:[e.jsxs(l,{colSpan:2,className:"px-4 py-3 sm:px-8 sm:py-5 font-bold text-foreground",children:[t," Total"]}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:e.jsxs("div",{className:"font-bold text-foreground font-mono text-base",children:["₹",d(r)]})}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsxs("div",{className:"font-bold text-foreground font-mono text-base",children:["₹",d(a)]}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:[(a/p*100).toFixed(1),"%"]})]}),e.jsx(l,{colSpan:2})]}),w=(t,a)=>{const r=h(t),n=t.xirr!==null&&t.xirr!==void 0,o=t.benchmark_xirr!==null&&t.benchmark_xirr!==void 0;return e.jsxs(x,{className:"hover:bg-muted/50",children:[e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 whitespace-normal max-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsxs(U,{children:[e.jsx(Q,{asChild:!0,children:e.jsx("div",{className:"font-bold text-foreground text-sm truncate flex-1 min-w-0 cursor-help",children:t.scheme_name})}),e.jsx(P,{children:e.jsx("p",{className:"max-w-xs break-words",children:t.scheme_name})})]}),t.style_category&&e.jsx(C,{variant:"secondary",className:"text-[10px] uppercase flex-shrink-0",children:t.style_category})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsx("div",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-wider truncate",title:t.sub_category,children:t.sub_category}),r&&e.jsx(C,{variant:"outline",className:"text-[10px] uppercase flex-shrink-0",children:r})]})]}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5",children:e.jsx("div",{className:"text-xs font-mono text-muted-foreground",children:t.date_of_entry||"-"})}),e.jsx(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:e.jsxs("div",{className:"font-bold text-foreground font-mono",children:["₹",d(t.cost_value||0)]})}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsxs("div",{className:"font-bold text-foreground font-mono",children:["₹",d(t.market_value||0)]}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:[((t.market_value||0)/p*100).toFixed(1),"%"]})]}),e.jsxs(l,{className:`px-4 py-3 sm:px-8 sm:py-5 text-right font-bold font-mono ${(t.gain_loss??0)>=0?"text-primary":"text-destructive"}`,children:[t.return_pct??0,"%"]}),e.jsxs(l,{className:"px-4 py-3 sm:px-8 sm:py-5 text-right",children:[e.jsx("div",{className:`font-bold font-mono text-sm ${n&&t.xirr<0?"text-red-500":"text-green-500"}`,children:n?`${t.xirr.toFixed(1)}%`:"-"}),e.jsxs("div",{className:"text-[10px] text-muted-foreground font-bold font-mono",children:["BM: ",o?`${t.benchmark_xirr.toFixed(1)}%`:"-"]})]})]},a)};return e.jsxs("div",{className:"mt-12 pt-12 border-t border-border",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-6",children:[e.jsx("h3",{className:"font-bold text-xl text-foreground",children:"Full Holding List"}),e.jsx(D,{title:"Full Holding List",formula:e.jsxs(e.Fragment,{children:["Value = Units × NAV",e.jsx("br",{}),"Allocation % = (Holding Value ÷ Total Portfolio Value) × 100",e.jsx("br",{}),"Return % = ((Current Value − Cost Value) ÷ Cost Value) × 100"]}),content:e.jsx(e.Fragment,{children:"All holdings from your statement: scheme name, category, market value (in ₹), allocation % of portfolio, return %, and style (e.g. Growth). Holdings are grouped by Equity and Debt with subtotals."})})]}),e.jsxs(M,{className:"overflow-hidden",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx($,{type:"text",placeholder:"Search by fund name, category, or style...",value:y,onChange:t=>F(t.target.value),className:"pl-9 w-full max-w-md"})]}),e.jsxs(A,{onClick:B,variant:"outline",size:"default",className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Download CSV"]})]}),e.jsx("div",{className:"w-full overflow-hidden",children:e.jsx("div",{className:"relative w-full overflow-hidden",children:e.jsxs("table",{className:"w-full caption-bottom text-sm table-fixed",children:[e.jsx(O,{children:e.jsxs(x,{className:"bg-muted border-b border-border",children:[e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 w-[25%]",children:"Fund Name / Category"}),e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 w-[12%]",children:"Entry Date"}),e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[15%]",children:"Invested Value"}),e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[15%]",children:"Current Value"}),e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[12%]",children:"Abs Returns"}),e.jsx(u,{className:"text-[10px] sm:text-xs font-bold uppercase tracking-widest px-4 py-3 sm:px-8 sm:py-5 text-right w-[21%]",children:"XIRR / BM"})]})}),e.jsxs(X,{children:[f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Equity"})}),f.map((t,a)=>w(t,`eq-${a}`)),_("Equity",R,E)]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Fixed Income / Debt"})}),g.map((t,a)=>w(t,`debt-${a}`)),_("Debt",L,H)]}),b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"bg-primary/10",children:e.jsx(l,{colSpan:6,className:"px-4 py-2 sm:px-8 sm:py-3 font-bold text-sm uppercase tracking-wider text-primary",children:"Others"})}),b.map((t,a)=>w(t,`other-${a}`)),_("Others",q,V)]})]})]})})})]})]})});export{Z as HoldingsTable};
